@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>Quét mã QR bàn ăn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Thư viện quét QR -->
    <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            overflow: hidden;
            position: relative;
        }

        /* Floating background elements */
        .bg-decoration {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .floating-element {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 6s ease-in-out infinite;
        }

            .floating-element:nth-child(1) {
                width: 80px;
                height: 80px;
                top: 10%;
                left: 10%;
                animation-delay: 0s;
            }

            .floating-element:nth-child(2) {
                width: 120px;
                height: 120px;
                top: 70%;
                right: 10%;
                animation-delay: 2s;
            }

            .floating-element:nth-child(3) {
                width: 60px;
                height: 60px;
                top: 20%;
                right: 20%;
                animation-delay: 4s;
            }

            .floating-element:nth-child(4) {
                width: 100px;
                height: 100px;
                bottom: 20%;
                left: 15%;
                animation-delay: 1s;
            }

        @@keyframes float {
            0%, 100%

        {
            transform: translateY(0px) rotate(0deg);
        }

        33% {
            transform: translateY(-20px) rotate(120deg);
        }

        66% {
            transform: translateY(-10px) rotate(240deg);
        }

        }

        .scanner-wrapper {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 40px 30px;
            text-align: center;
            max-width: 450px;
            width: 90%;
            position: relative;
            z-index: 1;
            animation: slideInUp 0.8s ease-out;
            overflow: hidden;
        }

            .scanner-wrapper::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 4px;
                background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff);
                animation: shimmer 3s ease-in-out infinite;
            }

        @@keyframes slideInUp {
            from

        {
            opacity: 0;
            transform: translateY(50px) scale(0.9);
        }

        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        }

        @@keyframes shimmer {
            0%

        {
            left: -100%;
        }

        50% {
            left: 100%;
        }

        100% {
            left: 100%;
        }

        }

        .header-section {
            margin-bottom: 30px;
            animation: fadeInDown 0.6s ease-out 0.2s both;
        }

        .qr-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.3);
        }

            .qr-icon::before {
                content: '📱';
                font-size: 28px;
            }

        @@keyframes pulse {
            0%, 100%

        {
            transform: scale(1);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.3);
        }

        50% {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(79, 172, 254, 0.5);
        }

        }

        @@keyframes fadeInDown {
            from

        {
            opacity: 0;
            transform: translateY(-20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }

        }

        h2 {
            margin-bottom: 10px;
            font-size: 1.8rem;
            color: #2c3e50;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .instructions {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
            opacity: 0.9;
        }

        .camera-container {
            position: relative;
            display: inline-block;
            animation: fadeIn 0.6s ease-out 0.4s both;
        }

        #preview {
            width: 100%;
            max-width: 300px;
            aspect-ratio: 1/1;
            border: 4px solid #4facfe;
            border-radius: 20px;
            background: #f8f9fa;
            margin-bottom: 20px;
            object-fit: cover;
            box-shadow: 0 15px 35px rgba(79, 172, 254, 0.2);
            transition: all 0.3s ease;
        }

            #preview:hover {
                transform: scale(1.02);
                box-shadow: 0 20px 45px rgba(79, 172, 254, 0.3);
            }

        /* Scanning overlay effect */
        .scanning-overlay {
            position: absolute;
            top: 4px;
            left: 4px;
            right: 4px;
            bottom: 20px;
            border-radius: 16px;
            pointer-events: none;
            overflow: hidden;
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff88, transparent);
            animation: scanning 2s ease-in-out infinite;
            box-shadow: 0 0 10px #00ff88;
        }

        @@keyframes scanning {
            0%

        {
            transform: translateY(0);
            opacity: 1;
        }

        50% {
            opacity: 1;
        }

        100% {
            transform: translateY(296px);
            opacity: 0;
        }

        }

        .corner-frames {
            position: absolute;
            top: 4px;
            left: 4px;
            right: 4px;
            bottom: 20px;
            border-radius: 16px;
            pointer-events: none;
        }

        .corner-frame {
            position: absolute;
            width: 30px;
            height: 30px;
            border: 3px solid #00ff88;
            animation: cornerPulse 1.5s ease-in-out infinite;
        }

            .corner-frame.top-left {
                top: 10px;
                left: 10px;
                border-right: none;
                border-bottom: none;
                border-top-left-radius: 10px;
            }

            .corner-frame.top-right {
                top: 10px;
                right: 10px;
                border-left: none;
                border-bottom: none;
                border-top-right-radius: 10px;
            }

            .corner-frame.bottom-left {
                bottom: 10px;
                left: 10px;
                border-right: none;
                border-top: none;
                border-bottom-left-radius: 10px;
            }

            .corner-frame.bottom-right {
                bottom: 10px;
                right: 10px;
                border-left: none;
                border-top: none;
                border-bottom-right-radius: 10px;
            }

        @@keyframes cornerPulse {
            0%, 100%

        {
            opacity: 1;
            transform: scale(1);
        }

        50% {
            opacity: 0.7;
            transform: scale(1.1);
        }

        }

        @@keyframes fadeIn {
            from

        {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }

        }

        .error {
            color: #e74c3c;
            margin-top: 15px;
            font-size: 1rem;
            padding: 12px;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 10px;
            border-left: 4px solid #e74c3c;
            animation: shake 0.5s ease-in-out;
        }

        @@keyframes shake {
            0%, 100%

        {
            transform: translateX(0);
        }

        25% {
            transform: translateX(-5px);
        }

        75% {
            transform: translateX(5px);
        }

        }

        .admin-login {
            margin-top: 30px;
            animation: fadeIn 0.6s ease-out 0.6s both;
        }

            .admin-login button {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                padding: 15px 25px;
                font-size: 1rem;
                font-weight: 600;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
                position: relative;
                overflow: hidden;
            }

                .admin-login button::before {
                    content: '';
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    width: 0;
                    height: 0;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 50%;
                    transition: all 0.6s ease;
                    transform: translate(-50%, -50%);
                }

                .admin-login button:hover::before {
                    width: 300px;
                    height: 300px;
                }

                .admin-login button:hover {
                    transform: translateY(-3px);
                    box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
                }

                .admin-login button:active {
                    transform: translateY(-1px);
                }

        .footer {
            font-size: 0.95rem;
            color: #7f8c8d;
            margin-top: 25px;
            line-height: 1.4;
            animation: fadeIn 0.6s ease-out 0.8s both;
        }

        /* Success animation */
        .scan-success {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 255, 136, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

            .scan-success.active {
                opacity: 1;
                visibility: visible;
            }

        .success-content {
            text-align: center;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            animation: successPop 0.6s ease-out;
        }

        @@keyframes successPop {
            0%

        {
            transform: scale(0.5);
            opacity: 0;
        }

        50% {
            transform: scale(1.2);
        }

        100% {
            transform: scale(1);
            opacity: 1;
        }

        }

        /* Responsive */
        @@media (max-width: 480px) {
            .scanner-wrapper

        {
            padding: 30px 20px;
            margin: 0 15px;
        }

        h2 {
            font-size: 1.5rem;
        }

        .instructions {
            font-size: 1rem;
        }

        #preview {
            max-width: 280px;
        }

        .admin-login button {
            padding: 12px 20px;
            font-size: 0.9rem;
        }

        }

        /* Loading state */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #4facfe;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @@keyframes spin {
            to

        {
            transform: rotate(360deg);
        }

        }
    </style>
</head>
<body>
    <div class="bg-decoration">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>

    <div class="scanner-wrapper">
        <div class="header-section">
            <div class="qr-icon"></div>
            <h2>Quét mã QR để gọi món</h2>
            <div class="instructions">Hướng camera vào mã QR dán tại bàn</div>
        </div>

        <div class="camera-container">
            <video id="preview"></video>
            <div class="scanning-overlay">
                <div class="scan-line"></div>
                <div class="corner-frames">
                    <div class="corner-frame top-left"></div>
                    <div class="corner-frame top-right"></div>
                    <div class="corner-frame bottom-left"></div>
                    <div class="corner-frame bottom-right"></div>
                </div>
            </div>
        </div>

        <div id="error-message" class="error" style="display: none;"></div>

        <div class="admin-login">
            <form method="get" action="/Login/Index">
                <button type="submit">
                    <span>🔐 Đăng nhập quản trị</span>
                </button>
            </form>
        </div>

        <div class="footer">
            ✨ Cảm ơn quý khách đã ủng hộ nhà hàng! ✨
        </div>
    </div>

    <div class="scan-success" id="scanSuccess">
        <div class="success-content">
            <div>✅ Quét thành công!</div>
            <div style="font-size: 1.2rem; margin-top: 10px;">Đang chuyển hướng...</div>
        </div>
    </div>

    <script>
        let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });

        scanner.addListener('scan', function (content) {
            console.log("Scanned content:", content);

            // Show success animation
            document.getElementById('scanSuccess').classList.add('active');

            // Add vibration if supported
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }

            // Delay redirect to show success animation
            setTimeout(() => {
                window.location.href = content; // chuyển trang ngay khi quét được
            }, 1500);
        });

        Instascan.Camera.getCameras().then(function (cameras) {
            if (cameras.length > 0) {
                let backCamera = cameras.find(c => c.name && c.name.toLowerCase().includes('back'));
                scanner.start(backCamera || cameras[0]);
            } else {
                const errorEl = document.getElementById('error-message');
                errorEl.innerText = "❌ Không tìm thấy camera!";
                errorEl.style.display = 'block';
            }
        }).catch(function (e) {
            const errorEl = document.getElementById('error-message');
            errorEl.innerText = "❌ Lỗi truy cập camera: " + e;
            errorEl.style.display = 'block';
            console.error(e);
        });

        // Add loading effect when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate camera loading
            setTimeout(() => {
                const preview = document.getElementById('preview');
                if (preview.srcObject) {
                    preview.style.filter = 'none';
                }
            }, 2000);
        });
    </script>
</body>
</html>